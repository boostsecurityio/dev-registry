api_version: 1.0

id: boostsecurityio/nuclei
name: nuclei
namespace: boostsecurityio/nuclei
scan_types:
  - sast
config:
  support_diff_scan: false


steps:
  - scan:
      command:
        docker:
          image: projectdiscovery/nuclei:latest
          command: -c 'nuclei -u $TARGET_URL -nm -irr -se /tmp/nuclei.sarif &>/dev/null; cat /tmp/nuclei.sarif'
#          command: -c 'nuclei -u $TARGET_URL -nm -irr -se /tmp/nuclei.sarif; cat /tmp/nuclei.sarif'
          entrypoint: sh
          workdir: /src
          environment:
            TARGET_URL: ${TARGET_URL}
            XDG_CONFIG_HOME: /tmp/nuclei
            HOME: /tmp
      format: sarif
      post-processor:
        docker:
          image: slef05/nuclei_py:v1
          workdir: /app
