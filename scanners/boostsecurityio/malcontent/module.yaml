api_version: 1.0

id: boostsecurityio/malcontent
name: Malcontent
namespace: boostsecurityio/malcontent
scan_types:
  - sast

config:
  support_diff_scan: true
  require_full_repo: true

steps:
  - scan:
      command:
        docker:
          image: cgr.dev/chainguard/malcontent:latest
          command: --format=json --min-risk=high analyze .
          workdir: /src
      format: sarif
      post-processor:
        docker:
          image: public.ecr.aws/boostsecurityio/boost-scanner-malcontent:ea4c635@sha256:b6f1cae9301aacac4d2256d260aa1a58c38f4683b06c518fb11208fa16eb2f3b
          command: process
