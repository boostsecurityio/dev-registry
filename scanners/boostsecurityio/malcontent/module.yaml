api_version: 1.0

id: boostsecurityio/malcontent
name: Malcontent
namespace: boostsecurityio/malcontent
scan_types:
  - sast

config:
  support_diff_scan: true
  require_full_repo: true

steps:
  - scan:
      command:
        docker:
          image: cgr.dev/chainguard/malcontent:latest
          command: --format=json --min-risk=high analyze .
          workdir: /src
      format: sarif
      post-processor:
        docker:
          image: public.ecr.aws/boostsecurityio/boost-scanner-malcontent:cbbe409@sha256:8e0e0b25e8302c5c64fe34abe398802afacc1a00f93248e62f7757c8bb45af98
          command: process
