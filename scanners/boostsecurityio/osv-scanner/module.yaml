api_version: 1.0


id: boostsecurityio/osv-scanner
name: BoostSecurity osv-scanner
namespace: boostsecurityio/osv-scanner
scan_types:
  - sca


config:
  support_diff_scan: true
  include_files:
    - buildscript-gradle.lockfile
    - Cargo.lock
    - composer.lock
    - conan.lock
    - Gemfile.lock
    - go.mod
    - gradle.lockfile
    - mix.lock
    - package-lock.json
    - packages.lock.json
    - pdm.lock
    - Pipfile.lock
    - pnpm-lock.yaml
    - poetry.lock
    - pom.xml
    - pubspec.lock
    - requirements.txt
    - renv.lock
    - yarn.lock


steps:
- scan:
    command:
      docker:
        image: slef05/osv-scanner-go:v1@sha256:8e326b8fe1f78258a7af28a9f46f2ae33b3f2e11b3babdf9bfbf263148210f00
        command: |
           sh -c osv-scanner scan --recursive --call-analysis=all --format json .
#          sh -c 'cd project;if ! osv-scanner scan --recursive --call-analysis=all --format json . ; then
#                   exit_code=$?
#                   if [ $exit_code -gt 128 ]; then
#                      exit $exit_code
#                   fi
#                 fi
#                '        
        workdir: /project
    format: sarif
    post-processor:
      docker:
          image: public.ecr.aws/boostsecurityio/boost-converter-sca:be29374@sha256:06d9d8712018128444eab3388215e58c18ab07952172792d89ad1093f18a6052
          command: process --scanner osv
          environment:
              PYTHONIOENCODING: utf-8
