api_version: 1.0

id: boostsecurityio/checkov
name: Checkov
namespace: boostsecurityio/checkov
scan_types:
  - iac

config:
  support_diff_scan: true
  require_full_repo: true

steps:
  - scan:
      command:
        docker:
          image: 289082777815.dkr.ecr.us-east-2.amazonaws.com/docker/bridgecrew/checkov:3.2.495@sha256:4c2c3b67f09867ef2843a03d8ba82adf712eb93ea3584c1708c24ed584f6da17
          command: --directory . --output json --soft-fail --quiet --skip-download --skip-framework secrets
          workdir: /src
      format: sarif
      post-processor:
        docker:
          image: public.ecr.aws/boostsecurityio/boost-scanner-checkov:be10260@sha256:7487b16d164de178d749e6dcf7ac1b1e4202904f0e4a773c334f3fc62049670f
          command: process
